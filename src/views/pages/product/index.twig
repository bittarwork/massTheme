{#
| Variable                   | Type        | Description                                                          |
|----------------------------|-------------|----------------------------------------------------------------------|
| page                       | object      |                                                                      |
| page.title                 | string      | *could be html                                                       |
| page.slug                  | string      | ex: "cat.show"                                                       |
| category                   | ?Category   |                                                                      |
| category.name              | string      |                                                                      |
| category.url               | string      |                                                                      |
| category.sub_categories    | ?Category[] |                                                                      |
| category.image             | ?string     |                                                                      |
| filters                     | bool        | is filters allowed here or not                                        |
| sort_options[]             | SortList[]  |                                                                      |
| sort_options[].id          | string      | ourSuggest, bestSell, topRated, priceFromTopToLow, priceFromLowToTop |
| sort_options[].name        | string      |                                                                      |
| sort_options[].is_selected | bool        | Is current page sorted by it                                         |
| search_query               | ?string     |                                                                      |
#}
{% extends "layouts.master" %}
{% block content %}
	<div class="container px-2.5 ms:px-5 mb-10">
		<nav class="breadcrumbs w-full py-5">
			<h1 class="font-bold text-5xl pr-8" id="page-main-title">{{ page.title|raw }}</h1>
			<div class="flex items-center justify-start flex-grow text-5xl">
				<salla-menu source="header"></salla-menu>
			</div>
		</nav>
		<div class="flex items-start flex-col md:flex-row">
			{% if filters %}
				<button class="btn--close-sm close-filters sicon-cancel hidden"></button>
				<salla-filters class="md:w-72 lg:sticky lg:top-20 flex-none" id="filters-menu"></salla-filters>
			{% endif %}

			<div class="main-content flex-1 w-full {{ filters ? 'ltr:lg:ml-8 rtl:lg:mr-8' : '' }}">
				{% hook 'product:index.items.start' %}
				<div class="flex min-h-screen">
					<div id="product-list" class="flex-1 min-w-0 overflow-auto"></div>
				</div>
				{% hook 'product:index.items.end' %}
			</div>
		</div>
	</div>

	{% if store.settings.category.testimonial_enabled %}
		{% component 'home.testimonials' %}
	{% endif %}
{% endblock %}

{% block scripts %} <script defer src="{{ 'product.js' | asset }}"></script>
	 <script>
			document.addEventListener('DOMContentLoaded', async () => {
				const productList = document.getElementById('product-list');
	
				// Replace with the URL or method to fetch your product data
				const response = await fetch('/api/products?slug={{ page.slug }}&id={{ page.id }}');
				const products = await response.json();
	
				products.forEach(product => {
					const productCard = document.createElement('custom-product-card');
					productCard.setAttribute('product', JSON.stringify(product));
					productList.appendChild(productCard);
				});
			});
		</script>
{% endblock %}
